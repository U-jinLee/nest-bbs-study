<div class="board-header">
  <h1>게시판</h1>
  <div class="board-actions">
    <div class="search-box">
      <input type="search" name="search" placeholder="검색어를 입력하세요" value="{{search}}" />
      <button class="btn-search" type="button">검색</button>
    </div>
    <a href="/posts/write" class="btn-primary">글쓰기</a>
  </div>
</div>
{{#each data}}
  <div class="board-list">
    <div class="post-item">
      <div class="post-header">
        <h3 class="post-title">
          <a href="/posts/{{id}}">{{title}}</a>
        </h3>
        <span class="post-meta"><b>{{author}}</b> {{createdAt}}</span>
      </div>
      <p class="post-excerpt">{{title}}</p>
      <div class="post-footer">
        <span class="post-stats">댓글 {{comments.length}}</span>
        <span class="post-stats">조회 0</span>
      </div>
    </div>
{{/each}}
{{#unless data.length}}
  <div style="text-align:center;padding:28px;border-radius:8px;border:1px dashed rgba(15,23,42,0.04);color:var(--muted);">게시글이 없습니다.</div>
{{/unless}}

<div class="pagination">  
  <button class="page-btn" {{#unless hasPreviousPage}}disabled{{/unless}}>이전</button>
  <div class="page-numbers" data-page-count="{{page}}" data-current-page="{{currentPage}}" data-limit="{{limit}}" data-search="{{search}}"></div>
  <button class="page-btn" {{#unless hasNextPage}}disabled{{/unless}}>다음</button>
</div>
<link rel="stylesheet" href="/list.css">
<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', () => {
    const pageNumbersContainer = document.querySelector('.page-numbers');
    const pageCount = parseInt(pageNumbersContainer.getAttribute('data-page-count'));
    const currentPage = parseInt(pageNumbersContainer.getAttribute('data-current-page'));
    const limit = parseInt(pageNumbersContainer.getAttribute('data-limit'));
    const search = pageNumbersContainer.getAttribute('data-search');

    pageNumbersContainer.innerHTML = '';

    for(let i = 1; i <= pageCount; i++) {
      const span = document.createElement('span');
      span.classList.add('page-number');
      if(i === currentPage) {
        span.classList.add('active');
      }
      span.textContent = i;
      span.addEventListener('click', () => {
        let url = `/posts?page=${i}&limit=${limit}`;
        if(search) {
          url += `&search=${encodeURIComponent(search)}`;
        }
        location.href = url;
      });
      pageNumbersContainer.appendChild(span);
    }
  });
  
  document.querySelector('.btn-search').addEventListener('click', () => {
    const query = document.querySelector('.search-box input').value;
    location.href = `/posts?search=${encodeURIComponent(query)}`;
  });
</script>