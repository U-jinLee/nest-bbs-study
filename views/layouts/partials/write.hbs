<div class="write-page">
  <div class="write-header">
    <div class="header-content">
      <h1>새 글 작성</h1>
      <p class="header-description">여러분의 생각과 이야기를 자유롭게 공유해주세요</p>
    </div>
  </div>
  <div class="write-container">
    <div class="write-form">
      <div class="form-group">
        <label for="title">제목</label>
        <input 
          type="text" 
          id="title" 
          name="title" 
          placeholder="글 제목을 입력하세요"
          required
          maxlength="100"
        />
      </div>

      <div class="form-group">
        <label for="author">작성자</label>
        <input 
          type="text" 
          id="author" 
          name="author" 
          placeholder="작성자명을 입력하세요"
          required
          maxlength="50"
        />
      </div>

      <div class="form-group">
        <label for="content">내용</label>
        <textarea 
          id="content" 
          name="content" 
          rows="12"
          placeholder="내용을 입력하세요..."
          required
        ></textarea>
      </div>

      <div class="form-actions">
        <button type="submit" id="post-submit" class="btn-secondary">
          작성 완료
        </button>
        <button type="button" class="btn-secondary" onclick="history.back()">
          취소
        </button>
      </div>
    </div>
  </div>
</div>
<link rel="stylesheet" href="/write.css">
<script type="text/javascript">
    document.getElementById('post-submit').addEventListener('click', () => {
        const title = document.getElementById('title').value;
        const content = document.getElementById('content').value;
        const author = document.getElementById('author').value;

        if(!(title || content || author)) {
            alert('모든 필드를 작성해주세요.');
            return;
        }

        fetch('/api/posts', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                content: content,
                title: title,
                author: author,
            })
        }).then(response => {
            if (response.ok) {
                response.json().then(data => {
                    alert('글이 성공적으로 작성되었습니다.');
                    window.location.href = `/posts/${data.id}`;
                });
            } else {
                alert('글 작성에 실패하였습니다.');
            }
        });
    })
</script>